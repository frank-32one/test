import{u as e,a as r,r as i,j as s,s as o,c as a}from"./index-BBRvJfK9.js";function t(){const t=e(),{user:n}=r();return i.useEffect((()=>{(async()=>{var e,r;try{const{data:{session:i},error:s}=await o.auth.getSession();if(s)return a.error("Authentication failed. Please try again."),void t("/login");if(null==i?void 0:i.user){const{data:s,error:n}=await o.from("profiles").select("*").eq("id",i.user.id).single();if(n&&"PGRST116"!==n.code)return a.error("Failed to load user profile"),void t("/login");if(!s){const{error:s}=await o.from("profiles").insert([{id:i.user.id,email:i.user.email,full_name:(null==(e=i.user.user_metadata)?void 0:e.full_name)||(null==(r=i.user.email)?void 0:r.split("@")[0]),user_type:"customer"}]);if(s)return a.error("Failed to create user profile"),void t("/login")}const l=(null==s?void 0:s.user_type)||"customer";t("provider"===l?"/dashboard":"/browse")}else a.error("No user session found"),t("/login")}catch(i){a.error("Authentication failed. Please try again."),t("/login")}})()}),[t]),s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})})}export{t as default};
